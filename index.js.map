{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const getImagesByQuery = async (query, page) => {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '49208970-c1347c58b4866d3d505700044',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page,\n        per_page: 15,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\n\nexport const galleryContainer = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.loader');\nexport const loadMoreButton = document.querySelector('.button-load');\n\nlet lightbox = new SimpleLightbox('.gallery a');\n\n// отрисовка галерии\nexport const createGallery = images => {\n  const markup = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n    <li class=\"gallery-img-list\">\n        <a href=\"${largeImageURL}\" class=\"gallery-link\">\n        <img class=\"img\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\"/>\n      </a>\n      <div class=\"info-wrapper\">\n        <div class=\"img-info\">\n          <p class=\"label\">Likes</p>\n          <p class=\"value\">${likes}</p>\n        </div>\n        <div class=\"img-info\">\n          <p class=\"label\">Views</p>\n          <p class=\"value\">${views}</p>\n        </div>\n        <div class=\"img-info\">\n          <p class=\"label\">Comments</p>\n          <p class=\"value\">${comments}</p>\n        </div>\n        <div class=\"img-info\">\n          <p class=\"label\">Downloads</p>\n          <p class=\"value\">${downloads}</p>\n        </div>\n      </div>\n    </li>`\n    )\n    .join('');\n\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n};\n\n// очистка галереи\nexport const clearGallery = () => {\n  galleryContainer.innerHTML = '';\n};\n\n// показ/скрытие лоадера\nexport const showLoader = () => {\n  loaderEl.classList.remove('is-hidden');\n};\nexport const hideLoader = () => {\n  loaderEl.classList.add('is-hidden');\n};\n\n// показ/скрытие кнопки LoadMore\nexport const showLoadMoreButton = () => {\n  loadMoreButton.classList.remove('is-hidden');\n};\nexport const hideLoadMoreButton = () => {\n  loadMoreButton.classList.add('is-hidden');\n};\n","import iziToast from 'izitoast';\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  loadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\n\nconst searchFormEl = document.querySelector('form');\n\nlet query = null;\nlet page = 1;\nlet totalHits = 0;\nconst perPage = 15;\n\nconst onFormSubmit = async event => {\n  event.preventDefault();\n\n  // ключевое слово, которое ввел пользователь\n  query = event.currentTarget.elements['search-text'].value.trim();\n\n  clearGallery(); // очистить галерею\n  hideLoadMoreButton(); // скрыть кнопку\n\n  page = 1; // обязательно, чтоб при смене ключ-слова страница начиналась с 1\n\n  if (query === '') {\n    iziToast.show({\n      message: 'Please enter your request!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  showLoader(); // показать loader перед запросом\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    const images = data.hits;\n    totalHits = data.totalHits;\n\n    if (images.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        backgroundColor: '#EF4040',\n        theme: 'dark',\n      });\n      return;\n    }\n\n    createGallery(images); // отрисовка галереи\n\n    if (page * perPage < totalHits) {\n      showLoadMoreButton(); // показать кнопку\n    } else {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      hideLoadMoreButton(); // скрыть кнопку, если картинок больше 15\n    }\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader(); // скрыть loader\n    searchFormEl.reset(); // очистить форму\n  }\n};\n\nconst onLoadMoreButton = async () => {\n  page++;\n  showLoader(); // показ loader\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    const images = data.hits;\n\n    createGallery(images); // отрисовка галереи\n\n    // прокрутка страницы при нажатии кнопки\n    const { height } = document\n      .querySelector('.gallery-img-list')\n      .getBoundingClientRect();\n    window.scrollBy({ top: height * 1.7, behavior: 'smooth' });\n\n    // если на следующей странице картинок меньше, чем perPage, скрываем кнопку\n    if (images.length < perPage) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n\n      hideLoadMoreButton(); // скрыть кнопку\n      return;\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader(); // скрыть loader\n  }\n};\n\nsearchFormEl.addEventListener('submit', onFormSubmit);\nloadMoreButton.addEventListener('click', onLoadMoreButton);\n"],"names":["getImagesByQuery","query","page","axios","error","galleryContainer","loaderEl","loadMoreButton","lightbox","SimpleLightbox","createGallery","images","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","searchFormEl","totalHits","perPage","onFormSubmit","event","iziToast","data","onLoadMoreButton","height"],"mappings":"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"}